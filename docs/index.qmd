---
title: Estimation of the effect of climate on infectious disesaes
format: 
  pdf:
    toc: true
    number-sections: true
    colorlinks: true
authors:
bibliography: bayes-climsens.bib
---

## Motivating Question 

If climate change (through some sort of variable such as temperature or precipitation) is affecting the number of cases of infectious diseasse, it is an outstanding question how strong this effect must be to identify it from some background autocorrelated value. 

How strong does the signal of climate change need to be to detect it? 

## Data & model 

Assuming we have some data on observed cases of a given infectious disease. The relationship between those observed cases and actual cases is a state process with some observation error, $\epsilon_o$. Cases themselves are now given as a state space model where the number of cases at time $t+1$ are driven by the effect of both temperature variance (consistent through time) and mean temperature (increasing through time), as well as an unobserved driver that is correlated through time with the mean temperature. 

Let:
- \( C_t \) represent the true number of cases at time \( t \).
- \( Y_t \) represent the observed number of cases at time \( t \), which includes observational error \( \epsilon_o \).
- \( T_t \) represent the mean temperature at time \( t \), and let \( V \) represent the temperature variance, assumed constant over time.
- \( U_t \) represent the unobserved driver correlated with mean temperature \( T_t \).

### State Process (Evolution) Equation

For the true cases \( C_t \), we specify that the cases at time \( t+1 \) are driven by the temperature effects and an unobserved driver \( U_t \) as follows:

\[
C_{t+1} \mid C_t, T_t, U_t \sim \text{Poisson} \left(C_t \exp \left( \alpha + \beta_T T_t + \beta_V V + \gamma U_t \right)\right)
\]

where:
- \( \alpha \) is an intercept term.
- \( \beta_T \) is the effect of mean temperature \( T_t \) on the cases.
- \( \beta_V \) is the effect of temperature variance \( V \).
- \( \gamma \) captures the effect of the unobserved driver \( U_t \) on the cases.

### Latent Driver Process

We assume that the unobserved driver \( U_t \) has temporal correlation and is influenced by the mean temperature:

\[
U_{t+1} \mid U_t, T_t \sim \mathcal{N}(\phi U_t + \eta T_t, \sigma_U^2)
\]

where:
- \( \phi \) is an autoregressive parameter governing the temporal correlation of \( U_t \).
- \( \eta \) is the strength of the correlation between \( U_t \) and \( T_t \).
- \( \sigma_U^2 \) is the variance of \( U_t \).

### Observation Equation

The observed cases \( Y_t \) are related to the true cases \( C_t \) with observation error \( \epsilon_o \):

\[
Y_t \mid C_t \sim \text{Poisson}(C_t e^{\epsilon_o})
\]

with \( \epsilon_o \sim \mathcal{N}(0, \sigma_o^2) \), where \( \sigma_o^2 \) is the variance of the observation error.

### Priors

The priors for the parameters could be specified as follows:

\[
\alpha \sim \mathcal{N}(0, 10), \quad \beta_T \sim \mathcal{N}(0, 1), \quad \beta_V \sim \mathcal{N}(0, 1), \quad \gamma \sim \mathcal{N}(0, 1)
\]
\[
\phi \sim \text{Uniform}(-1, 1), \quad \eta \sim \mathcal{N}(0, 1), \quad \sigma_U^2 \sim \text{Inverse-Gamma}(2, 1), \quad \sigma_o^2 \sim \text{Inverse-Gamma}(2, 1)
\]

### Model Summary

The Bayesian state space model can thus be summarized by:

1. **State Equation for \( C_t \):**
   \[
   C_{t+1} \vert C_t, T_t, U_t \sim \text{Poisson} \left(C_t \exp \left( \alpha + \beta_T T_t + \beta_V V + \gamma U_t \right)\right)
   \]

2. **Latent Driver Process \( U_t \):**
   \[
   U_{t+1} \vert U_t, T_t \sim \mathcal{N}(\phi U_t + \eta T_t, \sigma_U^2)
   \]

3. **Observation Equation for \( Y_t \):**
   \[
   Y_t \vert C_t \sim \text{Poisson}(C_t e^{\epsilon_o})
   \]
   with \( \epsilon_o \sim \mathcal{N}(0, \sigma_o^2) \).

This model structure accommodates both the observed temperature effects and an unobserved temporal driver, with observation noise on the actual reported cases.


